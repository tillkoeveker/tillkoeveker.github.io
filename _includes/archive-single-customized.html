
{%- comment -%}
Custom renderer for research items:
- Title links to external `paperurl` if present; otherwise internal page.
- Authors allow Markdown/HTML; bold names supported via <strong>.
- Venue + year shown with proper spacing.
- Buttons: PDF (paperurl), Code, Details (only if distinct internal page).
{%- endcomment -%}

<article class="archive-item">
  {%- assign has_paperurl = post.paperurl and post.paperurl != "" -%}
  {%- assign title_href = has_paperurl ? post.paperurl : post.permalink -%}

  <h3 class="archive-title" style="margin-bottom:0.25rem;">
    {%- if title_href -%}
      {{ title_href }}{{ post.title }}</a>
    {%- else -%}
      {{ post.title }}
    {%- endif -%}
    {%- if post.status_note -%}
      <span class="label label-default" style="margin-left:0.5rem;">{{ post.status_note }}</span>
    {%- endif -%}
  </h3>

  {%- if post.authors -%}
    <div class="archive-authors">
      {{ post.authors | markdownify | replace: '<p>','' | replace: '</p>','' }}
    </div>
  {%- endif -%}

  {%- assign year = post.date | date: "%Y" -%}
  {%- if post.venue or year -%}
    <div class="archive-venue" style="color:#777;">
      {%- if post.venue -%}{{ post.venue }}{%- endif -%}
      {%- if post.venue and year -%}, {%- endif -%}
      {%- if year -%}{{ year }}{%- endif -%}
    </div>
  {%- endif -%}

  {%- if post.excerpt -%}
    <div class="archive-excerpt" style="margin-top:0.5rem;">
      {{ post.excerpt }}
    </div>
  {%- endif -%}

  {%- if post.media_coverage and post.media_coverage.size > 0 -%}
    <div class="archive-media" style="margin-top:0.25rem;">
      [Media coverage:
        {%- for m in post.media_coverage -%}
          {{ m.url }}{{ m.name }}</a>{% unless forloop.last %}, {% endunless %}
        {%- endfor -%}
      ]
    </div>
  {%- endif -%}

  {%- comment -%}
  Buttons: show “PDF” if paperurl; “Code” if code; “Details” only if there is an internal page distinct from title link.
  {%- endcomment -%}
  {%- assign internal_page = post.permalink -%}
  {%- assign show_details = internal_page and internal_page != "" and internal_page != title_href -%}

  {%- if has_paperurl or post.code or show_details -%}
    <div class="archive-links" style="margin-top:0.5rem;">
      {%- if has_paperurl -%}
        <a class="btn btn}}PDF</a>
      {%- endif -%}
      {%- if post.code -%}
        {{ post.code }}Code</a>
      {%- endif -%}
      {%- if show_details -%}
        <a class="btn btn--sm"ails</a>
      {%- endif -%}
    </div>
  {%- endif -%}
</article>
